<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lua Script Obfuscator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            padding: 20px;
        }
        textarea {
            width: 100%;
            height: 150px;
            font-family: monospace;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        button {
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        pre {
            background-color: #eee;
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>

<h2>Lua Script Obfuscator</h2>
<textarea id="inputScript" placeholder="Enter Lua script to obfuscate..."></textarea>
<br>
<button onclick="obfuscate()">Obfuscate</button>

<h3>Obfuscated Script</h3>
<pre id="output"></pre>

<script>
function obfuscate() {
    let code = document.getElementById('inputScript').value;
    let obfuscatedCode = obfuscateLua(code);
    document.getElementById('output').innerText = obfuscatedCode;
}

function obfuscateLua(code) {
    // Basic obfuscation (rename variables and encode strings)
    let varPattern = /\b([a-zA-Z_][a-zA-Z0-9_]*)\b/g;
    let varMapping = {};

    // Replace variable names
    code = code.replace(varPattern, (match) => {
        if (!varMapping[match] && !isLuaKeyword(match)) {
            varMapping[match] = randomVarName();
        }
        return varMapping[match] || match;
    });

    // Encode strings (Base64)
    code = code.replace(/"(.*?)"/g, function(match, p1) {
        return 'decode("' + btoa(p1) + '")';
    });

    // Add random control flow confusion
    code = addControlFlowConfusion(code);

    return code;
}

function isLuaKeyword(word) {
    let keywords = ['and', 'break', 'do', 'else', 'elseif', 'end', 'false', 'for', 'function', 'if', 'in', 'local', 'nil', 'not', 'or', 'repeat', 'return', 'then', 'true', 'until', 'while'];
    return keywords.includes(word);
}

function randomVarName() {
    let chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
    let result = '';
    for (let i = 0; i < 8; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return result;
}

function btoa(str) {
    return window.btoa(unescape(encodeURIComponent(str)));
}

function addControlFlowConfusion(code) {
    let blocks = code.split("\n");
    for (let i = 0; i < blocks.length; i++) {
        if (Math.random() < 0.2) {
            blocks[i] = "if " + randomCondition() + " then \n" + blocks[i] + "\nend";
        }
    }
    return blocks.join("\n");
}

function randomCondition() {
    let conditions = ['true', 'false', '1 == 1', '0 == 1', 'not true', 'not false'];
    return conditions[Math.floor(Math.random() * conditions.length)];
}

// Lua decode function to reverse base64 encoding
function decode(str) {
    return decodeURIComponent(escape(window.atob(str)));
}
</script>

</body>
</html>
